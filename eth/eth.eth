(package eth (compile)

(import "./read" (read))
(import "./expand" (expand))
(import "./write" (write))

(defn compile (filename source)
  (let ((ast {:filename filename
              :source source})
        (read-ast (assoc :nodes (read filename source) ast))
        (expanded-ast (assoc :nodes (expand read-ast) read-ast)))
    (assoc :compiled (write expanded-ast) expanded-ast)))

)
